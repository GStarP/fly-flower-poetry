# 飞花令游戏用户界面设计方案

## 1. 设计概述

### 1.1 用户初步构想

- 整体风格能够体现出古风、典雅的感觉，同时也要简单、清爽，不要过于复杂。
- 应用始终只有一个页面，不会进行任何跳转。
  - 游戏开始前弹窗显示"限定字选择组件"；允许用户输入单个汉字作为限定字，或者从系统推荐的三个限定字中选择一个；用户还可以点击"换一批"，系统随机更换三个推荐限定字。
  - 选择限定字后游戏开始，机器人会先给出诗句，然后用户在底部的输入框中输入诗句内容，回车发送。双方的诗句（被验证合法的诗句）会显示在页面的主要区域，看上去就像聊天软件的对话一样，而其它比如错误提示之类的信息都是通过顶部的 toast 提示的，不要渲染到主要区域。
  - 游戏结束之后，会在主要区域的底部显示三条未在本局中使用的诗句以供用户学习。用户也可以继续查看本局双方发出的诗句。直到用户点击"再来一局"，才回到游戏开始前的状态，重新选择限定字。

### 1.2 设计目标

- **视觉风格**：打造古风典雅的视觉体验，同时保持界面简洁清爽
- **用户体验**：提供直观、流畅的交互体验，降低学习成本
- **响应式设计**：适配不同尺寸的设备，提供一致的用户体验
- **性能优化**：确保界面渲染和交互响应迅速，无卡顿

## 2. 视觉风格设计

### 2.1 色彩方案

采用中国传统色彩体系，主要色调包括：

| 颜色名称 | 色值     | 应用场景                     |
| -------- | -------- | ---------------------------- |
| 宣纸白   | #F7F4ED  | 背景色、主要区域背景         |
| 墨黑     | #1D1E20  | 主要文字、边框               |
| 朱砂红   | #C14C3A  | 强调色、按钮、重要信息       |
| 青瓷青   | #7AACB7  | 次要强调色、机器人诗句背景   |
| 竹青     | #789262  | 玩家诗句背景                 |
| 云灰     | #B0ABA9  | 次要文字、分割线、禁用状态   |

### 2.2 字体选择

为保持用户观看时的连贯性，整个应用统一使用一种字体：

- **全局字体**：使用具有书法韵味且清晰易读的「思源宋体」
- **字重变化**：通过不同的字重（light、regular、medium、bold）来区分不同类型的文本
- **字号变化**：通过不同的字号大小来强调层次结构

### 2.3 视觉元素

- **背景纹理**：采用淡雅的宣纸纹理作为全局背景，增强古典氛围
- **装饰元素**：使用中国传统纹样（如云纹、回纹）作为装饰，但保持简约
- **分割线**：使用仿毛笔水墨效果的分割线
- **按钮样式**：采用仿古典印章或卷轴风格的按钮设计
- **对话气泡**：设计成古典卷轴或书签形状

## 3. UI组件设计

### 3.1 核心组件

#### 3.1.1 限定字选择组件（CharacterSelector）

**功能描述**：
- 允许用户输入或选择限定字
- 提供系统推荐的限定字选项
- 提供"换一批"功能刷新推荐选项

**视觉设计**：
- 采用古典卷轴形式的弹窗
- 推荐的限定字以印章样式展示
- 输入框设计成毛笔书写的风格

**交互设计**：
- 点击推荐的限定字直接选择
- 输入框支持单个汉字输入，超过一个字符会被截断
- "换一批"按钮点击后有水墨扩散的动画效果

**组件接口**：
```typescript
interface CharacterSelectorProps {
  onSelect: (char: string) => void;
  onCancel?: () => void;
  recommendedChars?: string[];
  onRefreshRecommended?: () => void;
}
```

#### 3.1.2 诗句对话组件（PoetryChatItem）

**功能描述**：
- 展示单条诗句及相关信息
- 区分机器人和玩家的诗句

**视觉设计**：
- 机器人诗句：青瓷青背景，右对齐
- 玩家诗句：竹青背景，左对齐
- 诗句内容使用楷体字体
- 诗句来源（诗名、作者）使用小号宋体

**组件接口**：
```typescript
interface PoetryChatItemProps {
  sentence: Sentence;
  poetry?: Poetry;
  type: "player" | "robot";
  highlightChar?: string; // 高亮显示的限定字
}
```

#### 3.1.3 诗句输入组件（PoetryInput）

**功能描述**：
- 提供诗句输入框
- 支持回车发送
- 显示输入提示和验证状态

**视觉设计**：
- 输入框采用古典卷轴设计
- 发送按钮设计为毛笔或印章图标
- 输入提示文字采用淡灰色楷体

**交互设计**：
- 输入时实时检查是否包含限定字（视觉反馈）
- 回车键或点击发送按钮提交
- 发送成功后清空输入框

**组件接口**：
```typescript
interface PoetryInputProps {
  onSubmit: (content: string) => void;
  limitChar: string;
  disabled?: boolean;
  placeholder?: string;
}
```

#### 3.1.4 游戏结果组件（GameResult）

**功能描述**：
- 显示游戏结果（胜负、原因）
- 展示推荐学习的诗句
- 提供"再来一局"按钮

**视觉设计**：
- 结果信息采用卷轴设计
- 推荐诗句以书签形式展示
- "再来一局"按钮设计为印章样式

**组件接口**：
```typescript
interface GameResultProps {
  result: GameResult;
  onRestart: () => void;
}
```

#### 3.1.5 Toast提示组件（ToastNotification）

**功能描述**：
- 显示错误提示、操作反馈等临时信息
- 支持不同类型的提示（成功、错误、警告、信息）

**视觉设计**：
- 设计成古典卷轴或纸条样式
- 不同类型使用对应的颜色和图标

**组件接口**：
```typescript
interface ToastProps {
  type: "success" | "error" | "warning" | "info";
  message: string;
  duration?: number; // 显示时长（毫秒）
}
```

### 3.2 辅助组件

#### 3.2.1 游戏信息组件（GameInfo）

**功能描述**：
- 显示当前游戏状态（限定字、回合数等）
- 显示计时器（如果启用）

**视觉设计**：
- 设计成古典书签或印章样式
- 限定字使用较大字号，突出显示

#### 3.2.2 加载组件（LoadingIndicator）

**功能描述**：
- 显示加载状态（数据库加载、查询中等）

**视觉设计**：
- 设计成水墨扩散或毛笔书写的动画效果

#### 3.2.3 设置组件（SettingsPanel）

**功能描述**：
- 提供游戏设置选项（难度、时间限制等）

**视觉设计**：
- 设计成古典卷轴或书册样式
- 选项采用印章或墨迹效果

## 4. 页面布局设计

### 4.1 整体布局

采用单页面应用设计，页面分为以下几个主要区域：

```
+----------------------------------+
|            页面头部              | <- 游戏标题、设置按钮
+----------------------------------+
|                                  |
|                                  |
|           主要内容区             | <- 诗句对话展示
|                                  |
|                                  |
+----------------------------------+
|            页面底部              | <- 诗句输入框、操作按钮
+----------------------------------+
```

### 4.2 响应式布局策略

#### 4.2.1 桌面端（>= 1024px）

- 主要内容区采用居中布局，宽度限制在 800-1000px
- 诗句对话气泡最大宽度为 70%
- 左右留有足够空间展示背景纹理

#### 4.2.2 平板端（768px - 1023px）

- 主要内容区宽度调整为 90%
- 保持整体布局不变

#### 4.2.3 移动端（< 768px）

- 主要内容区宽度为 95%
- 诗句对话气泡最大宽度增加到 85%
- 设置按钮折叠到菜单中
- 输入框高度自适应

## 5. 交互流程设计

### 5.1 游戏初始化流程

1. 应用加载时显示加载动画（水墨扩散效果）
2. 数据库加载完成后显示限定字选择弹窗
3. 用户选择或输入限定字后关闭弹窗
4. 游戏开始，机器人先出诗句

### 5.2 游戏进行流程

1. 机器人出诗句后，诗句以动画方式出现在对话区
2. 玩家输入框激活，等待玩家输入
3. 玩家输入诗句并提交
4. 系统验证诗句：
   - 验证通过：诗句显示在对话区，机器人继续出诗
   - 验证失败：顶部显示 Toast 错误提示，输入框保持内容不变

### 5.3 游戏结束流程

1. 游戏结束条件触发（一方无法继续出诗）
2. 显示游戏结果信息
3. 在主要区域底部显示推荐学习的诗句
4. 玩家可以查看历史对话
5. 玩家点击"再来一局"按钮重新开始游戏

## 6. 动画与过渡效果

### 6.1 页面加载动画

- 水墨扩散效果，从中心向四周扩散
- 背景纹理渐显效果

### 6.2 诗句显示动画

- 新诗句以卷轴展开效果出现
- 限定字以墨迹渐显效果高亮

### 6.3 状态转换动画

- 游戏开始：背景轻微水墨晕染效果
- 游戏结束：结果卷轴从上方展开

### 6.4 按钮反馈动画

- 点击效果：墨迹扩散
- 悬停效果：轻微发光或阴影变化

## 7. 用户体验优化

### 7.1 加载优化

- 使用骨架屏（Skeleton）减少等待感
- 数据库加载时显示古风加载动画
- 预加载常用资源（图标、背景纹理等）

### 7.2 反馈机制

- 所有用户操作提供即时视觉反馈
- 错误提示使用友好的语言和明确的解决建议
- 成功操作给予积极的反馈（如水墨动画、音效等）

### 7.3 辅助功能

- 支持键盘操作（Tab导航、快捷键等）
- 适当的颜色对比度，确保文字清晰可读
- 提供操作提示和引导

## 8. 实现技术要点

### 8.1 组件实现

- 使用 React 函数式组件和 Hooks
- 使用 TypeScript 进行类型定义
- 基于 antd 组件库进行二次开发

### 8.2 样式实现

- 使用已安装的 styled-jsx 进行组件样式管理
- 使用 CSS 变量管理主题色和尺寸
- 使用 media query 实现响应式布局
- 创建全局样式文件定义通用样式和主题变量

### 8.3 动画实现

- 使用 CSS transitions 和 animations 实现基础动画
- 复杂动画考虑使用 React Spring 或 Framer Motion
- SVG 动画用于特殊效果（如水墨扩散）

## 9. 设计资源

### 9.1 图标资源

- 使用符合古风主题的自定义 SVG 图标
- 主要图标包括：设置、刷新、发送、返回等

### 9.2 背景纹理

- 宣纸纹理背景
- 水墨晕染效果
- 古典纹样装饰元素

### 9.3 字体资源

- 思源宋体（Source Han Serif）：包含不同字重
  - Light
  - Regular
  - Medium
  - Bold

## 10. 设计评估与迭代

### 10.1 评估指标

- 用户满意度
- 交互流畅度
- 视觉一致性
- 响应速度

### 10.2 迭代计划

- 第一阶段：实现核心界面和交互
- 第二阶段：完善视觉风格和动画效果
- 第三阶段：优化用户体验和性能
- 第四阶段：根据用户反馈进行调整

## 11. 总结

本用户界面设计方案以古风典雅为视觉基调，结合现代交互设计原则，旨在为用户提供沉浸式的飞花令游戏体验。通过精心设计的组件、布局和交互流程，确保用户能够轻松上手并享受游戏过程。同时，响应式设计确保在不同设备上都能获得一致的体验。
